<VirtualHost *:80>
  ServerName labo.res.ch

  # Round-robin load balancer, with no routing cookie.
  <Proxy "balancer://dynamic-balancer">
      </Proxy>
  ProxyPass "/api/transactions/" "balancer://dynamic-balancer/"
  ProxyPassReverse "/api/transactions/" "balancer://dynamic-balancer/"

  # Sticky load balancer (as long as the topology does not change too often).
  Header add Set-Cookie "ROUTEID=.%{BALANCER_WORKER_ROUTE}e; path=/" env=BALANCER_ROUTE_CHANGED
  <Proxy "balancer://static-balancer">
        ProxySet stickysession=ROUTEID
  </Proxy>
  ProxyPass "/" "balancer://static-balancer/"
  ProxyPassReverse "/" "balancer://static-balancer/"

</VirtualHost>
